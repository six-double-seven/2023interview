## 4. 词法分析 (Lexical analysis)

### 1. 介绍

词法分析程序又称扫描器
(1) 识别单词

- 从用户的源程序中把单词分离出来

(2) 翻译单词

- 把单词转换成机器内部的表示，便于后续处理



#### 1.1 单词的分类和识别

**(1) 单词的分类**

- 标识符：用户为一些变量起的名字

- 常数：以自身形态面对用户和系统

- 关键字：系统内部定义，具有固定的意义，通常用来区分语法单元

- 界符：单字符界符	+ - t i ,;: = < .

  ​      	双字符界符    >= ==**/ ...



**(2) 单词的识别**

- 字母开头：关键字或标识符
- 数字开头：数值型常量
- 单引号 或 双引号 开头：字符型常量或字符串常量
- 其它：多数以自身形态识别，如+，:=,



**(3) 如何区别关键字和标识符**

大多数编译程序使用 **保留字** ，即关键字不能用作标识符；

系统预先创造关键字表，识别出的字符串，先查 **关键字表**，查到了视为关键字，否则视为标识符。



#### 1.2 单词的机内表示

Token：类 | 值

类：语法信息，即单词的分类码(比如标识符、关键字等)；

值：语义信息，如：数组维数、上下界、类型等



**大致流程**

单词 --> 扫描器 / 词法分析器 --> Token --> 将Token传递给语法分析器。

![A design scheme of TOKEN](images\A design scheme of TOKEN.png)





### 2. 词法分析程序设计

#### 2.1 词法分析程序的分类

(1) 作为独立一遍的扫描器

- 整个源程序通过扫描器生成完整的Token序列，即Token序列和源程序是等价的；

(2) 扫描器作为语法分析器的子程序

- 语法分析器向扫描器发出getword命令，扫描器会去读取源程序；
- 每当扫描器识别出一个Token时，将Token返回给语法分析器；
- 语法分析器识别出一个完整的语法单元后，再生成语法分析后的Token序列。

![词法分析程序](images\词法分析程序.png)

#### 2.2 简单词法分析器的实现

词法分析器分为两个部分

(1) 识别器：识别单词的有限自动机；

(2) 翻译器：根据有限自动机所识别出的单词，完成从单词串 到 Token串 的翻译。



词法分析器大致的流程如下

![词法分析器流程](images\词法分析器流程.png)
